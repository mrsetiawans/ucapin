<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌊 {{TITLE}} untuk {{NAME}} 🌊</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Fauna+One&family=Lora:ital,wght@0,400;0,600;1,400&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Caveat:wght@400;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lora', serif;
            overflow-x: hidden;
            background: linear-gradient(170deg, #020c1a 0%, #05182e 25%, #0a284a 50%, #103860 75%, #081a30 100%);
            background-attachment: fixed;
            animation: ultraDeepSeaAmbience 40s ease-in-out infinite alternate;
            color: #e0f0ff; 
            position: relative;
            min-height: 100vh;
            padding: 2rem 1rem; 
        }

        @keyframes ultraDeepSeaAmbience {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }

        .seabed-container { /* Formerly hills-container */
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: auto;
            max-height: 45vh; 
            z-index: 1;
            pointer-events: none;
            overflow: hidden;
        }
        .seabed-container svg {
            width: 100%;
            height: 100%;
            display: block;
            position: absolute;
            bottom: 0;
        }
        
        .underwater-haze-container { /* Formerly mist-container */
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30vh; 
            overflow: hidden;
            z-index: 2; 
            pointer-events: none;
            opacity: 0.35; /* Slightly less opaque for water */
        }
        .haze-layer { /* Formerly mist-layer */
            position: absolute;
            bottom: -5vh; 
            left: 0;
            width: 250%; 
            height: 120%;
            background: linear-gradient(to top, rgba(10, 25, 45, 0.6) 0%, rgba(10, 25, 45, 0.35) 40%, rgba(10, 25, 45, 0) 100%);
            animation: driftHazeEnhanced 100s linear infinite;
        }
        .haze-layer.haze-layer-2 {
            width: 280%;
            animation-duration: 130s;
            animation-delay: -35s;
            opacity: 0.5;
            bottom: -8vh; 
        }
        @keyframes driftHazeEnhanced { /* Formerly driftMistEnhanced */
            0% { transform: translateX(0%); }
            50% { transform: translateX(-30%); } 
            100% { transform: translateX(0%); }
        }

        .bioluminescent-plankton { /* Formerly fireflies */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 3; 
            pointer-events: none;
        }
        .plankton-sparkle { /* Formerly firefly */
            position: absolute;
            width: var(--plankton-size, 2.5px); 
            height: var(--plankton-size, 2.5px);
            background: #a0e0f8; /* Light blue/cyan */
            border-radius: 50%;
            box-shadow: 
                0 0 calc(var(--plankton-size, 2.5px) * 2) #a0e0f8, 
                0 0 calc(var(--plankton-size, 2.5px) * 3.5) #b0f0ff, 
                0 0 calc(var(--plankton-size, 2.5px) * 5) #c0f8ff; 
            animation: driftPlanktonEnhanced 11s infinite linear; 
            opacity: 0;
        }
        /* Animation for plankton can be similar to fireflies, maybe a bit slower or more "floaty" */
        @keyframes driftPlanktonEnhanced { 0% { transform: translate(0, 0) scale(var(--plankton-scale-start, 0.4)); opacity: 0; } 10% { opacity: var(--plankton-opacity, 0.7); } 50% { transform: translate(var(--plankton-drift-x, 25px), var(--plankton-drift-y, -35px)) scale(var(--plankton-scale-mid, 1.0)); } 70% { opacity: calc(var(--plankton-opacity, 0.7) * 0.6); } 90% { opacity: var(--plankton-opacity, 0.7); } 100% { transform: translate(calc(var(--plankton-drift-x, 25px)*0.6), calc(var(--plankton-drift-y, -35px)*0.6)) scale(var(--plankton-scale-end, 0.4)); opacity: 0; } }
        
        .water-bubbles { /* Formerly forest-sparkles */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 4; 
            pointer-events: none;
        }
        .bubble { /* Formerly forest-sparkle */
            position: absolute;
            width: var(--bubble-size, 3px); /* Bubbles can be slightly larger */
            height: var(--bubble-size, 3px);
            background: rgba(173, 216, 230, 0.3); /* Light blue, semi-transparent */
            border: 1px solid rgba(200, 230, 255, 0.5);
            border-radius: 50%;
            box-shadow: 0 0 5px rgba(173, 216, 230, 0.4), 0 0 8px rgba(200, 230, 255, 0.3);
            animation: bubbleRiseEnhanced 9.5s infinite linear; 
            opacity: 0;
        }
         @keyframes bubbleRiseEnhanced { 0% { transform: translateY(100vh) translateX(0) rotate(0deg) scale(var(--bubble-scale-start,0.3)); opacity: 0; } 10% { opacity: 0.75; } 50% { transform: scale(var(--bubble-scale-mid,1.1)); } 90% { opacity: 0.75; } 100% { transform: translateY(-10vh) translateX(var(--bubble-drift-x, 30px)) rotate(120deg) scale(var(--bubble-scale-end,0.5)); opacity: 0; } }

        .container {
            position: relative;
            z-index: 10;
            max-width: 580px; 
            width: calc(100% - 2rem); 
            margin-left: auto;
            margin-right: auto;
        }

        .card {
            background: rgba(5, 20, 40, 0.92); /* Darker blue */
            backdrop-filter: blur(16px); 
            border: 2px solid rgba(70, 130, 180, 0.7); /* Ocean blue border */
            border-radius: 20px; 
            padding: clamp(2rem, 5.5vw, 2.6rem); 
            box-shadow: 0 25px 65px rgba(0, 0, 0, 0.8); 
            text-align: center;
            transform: scale(0.9) rotate(-1.5deg);
            opacity: 0;
            animation: cardAppearMagical 2s ease-out forwards 0.5s;
            position: relative;
            overflow: hidden;
        }
        @keyframes cardAppearMagical { to { transform: scale(1) rotate(0deg); opacity: 1; } }
        .card::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(100, 160, 220, 0.09) 0%, transparent 70%); animation: magicalShineDeeper 11s infinite linear; opacity: 0.5; }
        @keyframes magicalShineDeeper { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .header-title { font-family: 'Cinzel Decorative', cursive; font-size: clamp(2.1rem, 7.2vw, 3.9rem); font-weight: 700; color: #b0e0e6; margin-bottom: 1.1rem; text-shadow: 0 0 15px rgba(130, 190, 240, 0.65), 0 0 25px rgba(150, 210, 255, 0.45); animation: titleGlowMysticEnhanced 3.2s ease-in-out infinite alternate; position: relative; z-index: 2; }
        .card.content-revealed .header-title { font-family: 'Cinzel', serif; font-size: clamp(1.75rem, 5.6vw, 2.75rem); font-weight: 700; letter-spacing: 1px; text-transform: uppercase; color: #d0e8f8; }
        @keyframes titleGlowMysticEnhanced { from { text-shadow: 0 0 13px rgba(130, 190, 240, 0.6), 0 0 22px rgba(150, 210, 255, 0.4); opacity: 0.92; } to { text-shadow: 0 0 24px rgba(130, 190, 240, 0.75), 0 0 40px rgba(150, 210, 255, 0.6), 0 0 9px #f0f8ff; opacity: 1; } }
        
        .subtitle { 
            font-family: 'Fauna One', serif; 
            font-size: clamp(0.98rem, 3.9vw, 1.32rem); 
            margin-bottom: 2.2rem; 
            color: rgba(190, 220, 250, 0.93); 
            font-weight: 400; 
            animation: subtitleFadeMystic 2s ease-out 1s forwards; 
            opacity: 0; 
        }
        @keyframes subtitleFadeMystic { 
            to { opacity: 0.93; } 
        }

        #countdown { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin: 2.2rem 0; animation: countdownAppear 2s ease-out 1.2s forwards; opacity: 0; }
        @media (min-width: 500px) { #countdown { grid-template-columns: repeat(4, 1fr); } } @keyframes countdownAppear { to { opacity: 1; } }
        .countdown-item { background: rgba(60, 110, 150, 0.28); border: 1px solid rgba(80, 140, 200, 0.7); border-radius: 16px; padding: 1rem; backdrop-filter: blur(9px); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; overflow: hidden; box-shadow: 0 0 16px rgba(80, 140, 200, 0.45); }
        .countdown-item:hover { transform: translateY(-8px) scale(1.08); box-shadow: 0 10px 33px rgba(15, 40, 70, 0.65), 0 0 24px rgba(80, 140, 200, 0.75); }
        .countdown-number { font-family: 'Cinzel Decorative', cursive; font-size: clamp(1.55rem, 5.6vw, 2.35rem); font-weight: 700; color: #d0e8f0; display: block; text-shadow: 0 1px 9px rgba(0,0,0, 0.6); }
        .countdown-label { font-family: 'Fauna One', serif; font-size: clamp(0.62rem, 2.75vw, 0.82rem); color: rgba(175, 205, 235, 0.9); text-transform: uppercase; letter-spacing: 1.2px; margin-top: 0.5rem; font-weight: 400; }
        .reveal-btn { background: linear-gradient(45deg, #1e508b, #0a2d50, #2a6bad); background-size: 250% 250%; color: #e0f8ff; border: 1px solid rgba(100, 170, 220, 0.55); padding: 0.9rem 1.8rem; border-radius: 30px; font-family: 'Cinzel Decorative', cursive; font-size: clamp(0.9rem, 3.8vw, 1.1rem); font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 7px 28px rgba(3, 15, 30, 0.7), inset 0 -3px 8px rgba(0,0,0,0.4); animation: btnPulseMysticEnhanced 2.6s infinite, btnGradientShiftMystic 5s ease infinite; margin: 2.2rem 0; display: none; text-transform: uppercase; letter-spacing: 1px; }
        @keyframes btnGradientShiftMystic { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
        @keyframes btnPulseMysticEnhanced { 0% { transform: scale(1); box-shadow: 0 7px 28px rgba(3, 15, 30, 0.7), inset 0 -3px 8px rgba(0,0,0,0.4); } 50% { transform: scale(1.04); box-shadow: 0 9px 36px rgba(3, 15, 30, 0.9), 0 0 24px #a0d8f0, inset 0 -3px 8px rgba(0,0,0,0.4); } 100% { transform: scale(1); box-shadow: 0 7px 28px rgba(3, 15, 30, 0.7), inset 0 -3px 8px rgba(0,0,0,0.4); } }
        .reveal-btn:hover { transform: translateY(-4px) scale(1.04); box-shadow: 0 11px 36px rgba(3, 15, 30, 0.8), 0 0 30px #c0e8ff, inset 0 -3px 8px rgba(0,0,0,0.45); }
        .birthday-content { display: none; animation: contentAppearMystic 2s ease-out forwards; margin-top: 2.2rem; }
        @keyframes contentAppearMystic { 0% { opacity: 0; transform: translateY(20px) scale(0.95); } 100% { opacity: 1; transform: translateY(0) scale(1); } }
        .birthday-message { background: rgba(80, 130, 170, 0.15); border-radius: 16px; padding: 1.6rem; margin: 1.1rem 0; border: 1px solid rgba(100, 160, 210, 0.55); backdrop-filter: blur(9px); font-size: clamp(0.9rem, 3.5vw, 1.05rem); line-height: 1.75; color: #e0f0ff; }
        .birthday-message h2 { font-family: 'Cinzel Decorative', cursive; color: #b0e0e6; margin-bottom: 0.8rem; font-size: clamp(1.5rem, 4.5vw, 2.2rem); font-weight: 700; }
        .special-wish-btn { background: linear-gradient(45deg, #4682b4, #3a729b); color: #020c1a; border: 1px solid rgba(120, 200, 230, 0.45); padding: 0.8rem 1.6rem; border-radius: 25px; font-family: 'Fauna One', serif; font-size: clamp(0.8rem, 3.2vw, 1rem); font-weight: 600; cursor: pointer; margin: 1.6rem 0; transition: all 0.3s ease; display: none; box-shadow: 0 5px 22px rgba(15, 40, 70,0.5); }
        .special-wish-btn:hover { transform: translateY(-3px); box-shadow: 0 9px 30px rgba(15, 40, 70,0.6), 0 0 18px #d0e8f0; }
        .special-wish-container { display: none; background: rgba(7, 20, 35, 0.94); color: #e0f0ff; border-radius: 16px; padding: 1.8rem; margin: 1.6rem 0; box-shadow: 0 12px 42px rgba(0, 0, 0, 0.65); text-align: left; line-height: 1.8; font-size: clamp(0.88rem, 3.1vw, 0.98rem); border: 1px solid #2a506a; animation: fadeInSpecialWish 1s ease-out; }
        @keyframes fadeInSpecialWish { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .special-wish-container strong { color: #b0e0e6; font-weight: 600; } .special-wish-container em { color: #d0e8f0; font-style: italic; font-weight: 400; }
        .from-sender { text-align: right; margin-top: 1.5rem; font-style: italic; color: #cad8e0; font-size: 0.9em; }
        .footer { margin-top: 2.2rem; font-size: clamp(0.8rem, 2.8vw, 0.9rem); color: rgba(190, 220, 250, 0.88); font-weight: 400; font-family: 'Fauna One', serif; }
        
        .bubble-float-container { /* Formerly leaf-fall-container */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 15;
            pointer-events: none;
            display: none;
        }
        .bubble-particle { /* Formerly leaf */
            position: absolute;
            width: clamp(10px, 2.5vw, 20px); /* Bubbles can be smaller */
            height: clamp(10px, 2.5vw, 20px);
            background-size: contain;
            background-repeat: no-repeat;
            animation: floatUpDeepSea 10s linear infinite; /* Renamed animation */
            opacity: 0;
        }
        @keyframes floatUpDeepSea { /* Formerly fallDeeperForest, reversed direction */
            0% { transform: translateY(110vh) translateX(0px) rotate(0deg) scale(0.5); opacity: 0.6; } /* Start from bottom, slightly visible */
            25% { transform: translateX(var(--bubble-drift-x-mid, 30px)) rotate(-60deg); opacity: 0.8; }
            100% { transform: translateY(-10vh) translateX(var(--bubble-drift-x-end, 70px)) rotate(-320deg) scale(1); opacity: 0; } /* End at top, fade out */
        }

        .badge { position: absolute; top: -11px; right: -11px; background: linear-gradient(135deg, #2a6bad, #0a2d50); color: #e0f8ff; border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; font-size: 23px; animation: badgeSway 3s ease-in-out infinite; box-shadow: 0 5px 18px rgba(3, 15, 30, 0.6); z-index: 100; }
        @keyframes badgeSway { 0%, 100% { transform: rotate(-5deg) scale(1); } 50% { transform: rotate(5deg) scale(1.1); } }

         @media (max-width: 768px) {
            body { padding: 1rem 0.5rem; }
            .container { width: calc(100% - 1rem); margin-top: 1rem; margin-bottom: 1rem; }
            .card { padding: 2rem; }
            .seabed-container { max-height: 40vh; }
            #countdown { gap: 0.8rem; } .countdown-item { padding: 0.9rem; } .header-title { font-size: clamp(2.0rem, 7vw, 3.5rem); } .card.content-revealed .header-title { font-size: clamp(1.7rem, 5.2vw, 2.6rem); } .subtitle { font-size: clamp(0.9rem, 3.5vw, 1.25rem); } .birthday-message h2 { font-size: clamp(1.4rem, 4vw, 2.0rem); }
        }
        @media (max-width: 480px) {
            .seabed-container { max-height: 35vh; }
            .card { padding: 1.3rem; border-radius: 15px; } #countdown { gap: 0.5rem; } .countdown-item { padding: 0.7rem; border-radius: 10px; } .reveal-btn { padding: 0.8rem 1.5rem; font-size: 0.85rem; } .header-title { font-size: clamp(1.8rem, 7.2vw, 3.2rem); } .card.content-revealed .header-title { font-size: clamp(1.5rem, 4.8vw, 2.3rem); } .subtitle { font-size: clamp(0.85rem, 3.8vw, 1.15rem); margin-bottom: 1.8rem; } .birthday-message h2 { font-size: clamp(1.3rem, 3.8vw, 1.8rem); }
        }
    </style>
</head>
<body>
    <!-- Background Seabed Layers (Corals, Rocks) -->
    <div class="seabed-container">
        <svg viewBox="0 0 1200 350" preserveAspectRatio="xMidYMax slice" style="z-index: 1; opacity: 0.65;">
            <defs><filter id="slightBlurDeep" x="-20%" y="-20%" width="140%" height="140%"><feGaussianBlur in="SourceGraphic" stdDeviation="0.5"/></filter></defs>
            <path d="M0,350 L0,240 Q130,200 290,240 T580,210 T850,250 T1100,200 T1200,230 L1200,350 Z" fill="#030a12" filter="url(#slightBlurDeep)"/>
            <path d="M0,350 L0,250 Q100,220 250,250 T520,230 T780,260 T1020,220 T1200,240 L1200,350 Z" fill="#04101b" transform="translate(30, 5) scale(1.02)" filter="url(#slightBlurDeep)"/>
        </svg>
        <svg viewBox="0 0 1200 320" preserveAspectRatio="xMidYMax slice" style="z-index: 2; opacity: 0.8; bottom: -3vh;">
            <path d="M0,320 L0,210 Q160,170 340,210 T630,180 T900,220 T1150,170 T1200,200 L1200,320 Z" fill="#081c30"/>
            <path d="M0,320 L0,220 Q140,190 300,220 T590,200 T860,230 T1120,190 T1200,210 L1200,320 Z" fill="#0a2038" transform="translate(-25, 6) scale(1.03)"/>
            <ellipse cx="150" cy="195" rx="15" ry="10" fill="#2a526a" opacity="0.7"/> <ellipse cx="170" cy="185" rx="12" ry="8" fill="#3b708c" opacity="0.7"/>
            <ellipse cx="450" cy="190" rx="18" ry="12" fill="#4f8caa" opacity="0.7"/> <ellipse cx="480" cy="180" rx="16" ry="10" fill="#3c6c80" opacity="0.7"/>
            <ellipse cx="750" cy="200" rx="16" ry="11" fill="#507D96" opacity="0.7"/> <ellipse cx="785" cy="190" rx="13" ry="9" fill="#608da8" opacity="0.7"/>
            <ellipse cx="1050" cy="185" rx="20" ry="13" fill="#2E5A75" opacity="0.7"/> <ellipse cx="1020" cy="195" rx="15" ry="10" fill="#386a84" opacity="0.7"/>
        </svg>
        <svg viewBox="0 0 1200 280" preserveAspectRatio="xMidYMax slice" style="z-index: 3; opacity: 0.95; bottom: -6vh;">
            <path d="M0,280 L0,190 Q190,150 380,190 T680,160 T980,200 T1200,170 L1200,280 Z" fill="#103050"/>
            <path d="M0,280 L0,200 Q170,170 360,200 T660,180 T960,210 T1200,190 L1200,280 Z" fill="#0e2842" transform="translate(20, 7) scale(1.02)"/>
            <ellipse cx="250" cy="175" rx="28" ry="20" fill="#4682B4" opacity="0.8"/> <ellipse cx="280" cy="165" rx="25" ry="18" fill="#5a94c2" opacity="0.8"/>
            <ellipse cx="550" cy="170" rx="33" ry="22" fill="#87CEEB" opacity="0.8"/> <ellipse cx="590" cy="160" rx="30" ry="20" fill="#add8e6" opacity="0.8"/>
            <ellipse cx="850" cy="180" rx="30" ry="21" fill="#6CA6CD" opacity="0.8"/> <ellipse cx="820" cy="190" rx="28" ry="19" fill="#7CB9DE" opacity="0.8"/>
        </svg>
    </div>

    <div class="underwater-haze-container">
        <div class="haze-layer"></div>
        <div class="haze-layer haze-layer-2"></div>
    </div>

    <div class="bioluminescent-plankton" id="plankton-container"></div>
    <div class="water-bubbles" id="bubbles-container"></div>

    <div class="container">
        <div class="card" id="mainCard">
            <div class="badge">🌊</div>
            
            <h1 id="main-title" class="header-title">{{TITLE}}</h1>
            <p id="subtitle" class="subtitle">{{SUBTITLE}}</p>
            
            <div id="countdown">
                <div class="countdown-item"> <span id="days" class="countdown-number">00</span> <div class="countdown-label">Hari</div> </div>
                <div class="countdown-item"> <span id="hours" class="countdown-number">00</span> <div class="countdown-label">Jam</div> </div>
                <div class="countdown-item"> <span id="minutes" class="countdown-number">00</span> <div class="countdown-label">Menit</div> </div>
                <div class="countdown-item"> <span id="seconds" class="countdown-number">00</span> <div class="countdown-label">Detik</div> </div>
            </div>

            <button id="reveal-btn" class="reveal-btn"> 🐚 Selami Keajaiban Lautan 🐚 </button>

            <div id="birthday-content" class="birthday-content">
                <div class="birthday-message"> <h2>🌊 Selamat Ulang Tahun, {{NAME}}! 🌊</h2> <p>{{MESSAGE_1}}</p> </div>
                <div class="birthday-message"> <p>{{MESSAGE_2}}</p> </div>
                <div class="birthday-message"> <p>{{MESSAGE_3}}</p> </div>
                <button id="special-wish-btn" class="special-wish-btn"> 📜 Buka Gulungan Pesan dari Palung Hati 📜 </button>
                <div id="special-wish-container" class="special-wish-container"></div>
            </div>

            <div class="footer"> ⚓ Dari Palung Hati yang Terdalam, {{SENDER}} ⚓ </div>
        </div>
    </div>

    <div class="bubble-float-container" id="bubble-float-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const planktonContainer = document.getElementById('plankton-container');
            const bubblesContainer = document.getElementById('bubbles-container');
            const bubbleFloatContainer = document.getElementById('bubble-float-container');
            
            const numPlankton = window.innerWidth < 768 ? 150 : 300;
            const numBubbles = window.innerWidth < 768 ? 45 : 80;

            function createBioluminescentPlankton() {
                if (!planktonContainer) return;
                planktonContainer.innerHTML = ''; 
                for (let i = 0; i < numPlankton; i++) {
                    const plankton = document.createElement('div');
                    plankton.className = 'plankton-sparkle';
                    plankton.style.left = Math.random() * 100 + 'vw';
                    plankton.style.top = Math.random() * 100 + 'vh';
                    plankton.style.animationDelay = Math.random() * 11 + 's';
                    plankton.style.animationDuration = (Math.random() * 7 + 6) + 's';
                    plankton.style.setProperty('--plankton-drift-x', (Math.random() - 0.5) * 90 + 'px');
                    plankton.style.setProperty('--plankton-drift-y', (Math.random() - 0.5) * 90 + 'px');
                    plankton.style.setProperty('--plankton-opacity', (Math.random() * 0.4 + 0.4).toFixed(2)); 
                    let size; const sizeRoll = Math.random();
                    if (sizeRoll < 0.35) { size = Math.random() * 0.7 + 0.8; } 
                    else if (sizeRoll < 0.65) { size = Math.random() * 0.9 + 1.5; } 
                    else if (sizeRoll < 0.90) { size = Math.random() * 1.1 + 2.4; } 
                    else { size = Math.random() * 1.0 + 3.5; }
                    plankton.style.setProperty('--plankton-size', size.toFixed(1) + 'px');
                    plankton.style.setProperty('--plankton-scale-start', (Math.random() * 0.2 + 0.3).toFixed(2));
                    plankton.style.setProperty('--plankton-scale-mid', (Math.random() * 0.3 + 0.75).toFixed(2));
                    plankton.style.setProperty('--plankton-scale-end', (Math.random() * 0.2 + 0.3).toFixed(2));
                    planktonContainer.appendChild(plankton);
                }
            }

            function createWaterBubbles() {
                if (!bubblesContainer) return;
                bubblesContainer.innerHTML = ''; 
                for (let i = 0; i < numBubbles; i++) {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble';
                    bubble.style.left = Math.random() * 100 + 'vw';
                    bubble.style.animationDelay = Math.random() * 9.5 + 's'; 
                    bubble.style.setProperty('--bubble-drift-x', (Math.random() - 0.5) * 100 + 'px');
                    let size = Math.random() * 3 + 1.5;
                    bubble.style.setProperty('--bubble-size', size.toFixed(1) + 'px');
                    bubble.style.setProperty('--bubble-scale-start', (Math.random() * 0.3 + 0.2).toFixed(2));
                    bubble.style.setProperty('--bubble-scale-mid', (Math.random() * 0.4 + 0.8).toFixed(2));
                    bubble.style.setProperty('--bubble-scale-end', (Math.random() * 0.3 + 0.4).toFixed(2));
                    bubblesContainer.appendChild(bubble);
                }
            }

            function createFloatingBubbles() {
                if (!bubbleFloatContainer) return;
                bubbleFloatContainer.innerHTML = ''; 
                bubbleFloatContainer.style.display = 'block';
                const bubbleColors = ['rgba(173,216,230,0.5)', 'rgba(200,230,255,0.4)', 'rgba(220,240,255,0.6)', 'rgba(150,200,240,0.35)']; 
                const bubbleCount = window.innerWidth < 768 ? 40 : 65; 
                for (let i = 0; i < bubbleCount; i++) {
                    const bubbleP = document.createElement('div');
                    bubbleP.className = 'bubble-particle';
                    const randomColor = bubbleColors[Math.floor(Math.random() * bubbleColors.length)];
                    bubbleP.style.backgroundImage = `url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="${randomColor.replace('rgba(', 'rgba%28').replace(')', '%29').replace(/,/g, '%2C')}" stroke="rgba(230,245,255,0.7)" stroke-width="3"/></svg>')`;
                    bubbleP.style.left = Math.random() * 100 + 'vw';
                    bubbleP.style.animationDelay = Math.random() * 10 + 's';
                    bubbleP.style.animationDuration = (Math.random() * 6 + 7) + 's'; 
                    bubbleP.style.setProperty('--bubble-drift-x-mid', (Math.random() - 0.5) * 120 + 'px'); 
                    bubbleP.style.setProperty('--bubble-drift-x-end', (Math.random() - 0.5) * 200 + 'px'); 
                    bubbleFloatContainer.appendChild(bubbleP);
                }
            }

            const cardEl = document.getElementById('mainCard');
            const countdownEl = document.getElementById('countdown');
            const birthdayContentEl = document.getElementById('birthday-content');
            const mainTitleEl = document.getElementById('main-title');
            const subtitleEl = document.getElementById('subtitle');
            const specialWishBtn = document.getElementById('special-wish-btn');
            const specialWishContainer = document.getElementById('special-wish-container');
            const revealBtn = document.getElementById('reveal-btn');
            
            const specialWishContent = `{{SPECIAL_WISH}}`;
            const birthdayDate = new Date({{YEAR}}, {{MONTH}} - 1, {{DAY}}, 0, 0, 0).getTime();
            const thirtyDaysInMs = 30 * 24 * 60 * 60 * 1000;

            const audio = new Audio('https://cdn.sanity.io/files/zhgxj6ko/production/20096b856584fe42be47145334272a834c663ffe.mp3');
            audio.loop = true;
            let musicStarted = false;

            if (revealBtn) {
                revealBtn.addEventListener('click', () => {
                    revealBtn.style.display = 'none';
                    if (cardEl) cardEl.classList.add('content-revealed');
                    if (mainTitleEl) { mainTitleEl.innerHTML = "🌊 KEBIJAKSANAAN LAUTAN UNTUKMU 🌊"; }
                    if (subtitleEl) { 
                        subtitleEl.innerHTML = `{{NAME}}, Sebuah Pesan dari Lautan Telah Tiba! 📜`; 
                        subtitleEl.style.animation = 'none'; 
                        subtitleEl.style.opacity = '0.93';   
                    }
                    if (birthdayContentEl) birthdayContentEl.style.display = 'block';
                    if (specialWishBtn) specialWishBtn.style.display = 'inline-block';
                    createFloatingBubbles();
                    if (!musicStarted) {
                        audio.play().catch(e => console.log("Autoplay blocked"));
                        musicStarted = true;
                    }
                });
            }

            if (specialWishBtn) {
                specialWishBtn.addEventListener('click', () => {
                    if (specialWishContainer) {
                        specialWishContainer.innerHTML = specialWishContent + `<div class="from-sender">- {{SENDER}} -</div>`;
                        specialWishContainer.style.display = 'block';
                        specialWishContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }
                });
            }

            function updateCountdown() {
                const now = Date.now();
                const targetBirthdayTime = birthdayDate; 
                if (now > targetBirthdayTime + thirtyDaysInMs) {
                    if (countdownEl) countdownEl.style.display = 'none';
                    if (revealBtn) revealBtn.style.display = 'none';
                    if (cardEl) cardEl.classList.add('content-revealed'); 
                    if (mainTitleEl) mainTitleEl.innerHTML = "⚓ Jejak Samudra Menuju Tahun Depan ⚓";
                    if (subtitleEl) {
                        subtitleEl.innerHTML = `{{NAME}}, samudra menyimpan bisikan harapan untuk pelayaran berikutnya...`;
                        subtitleEl.style.animation = 'none'; 
                        subtitleEl.style.opacity = '0.93';
                    }
                    if (birthdayContentEl) {
                        birthdayContentEl.style.display = 'block'; 
                        birthdayContentEl.innerHTML = `<div class="birthday-message"><h2>🌟 Menantikan Musim Pasang Bersamamu 🌟</h2><p>Saudaraku {{NAME}}, seperti lautan yang menyambut gelombang baru, kami menantikan perayaanmu berikutnya. Semoga sisa tahun ini memberimu ketenangan dari samudra.</p></div>`;
                        if (specialWishBtn) specialWishBtn.style.display = 'none'; 
                        if (specialWishContainer) specialWishContainer.style.display = 'none';
                    }
                    if (countdownInterval) clearInterval(countdownInterval);
                    return;
                } else if (now >= targetBirthdayTime) { 
                    if (countdownEl) countdownEl.style.display = 'none';
                    if (revealBtn && birthdayContentEl && birthdayContentEl.style.display !== 'block') {
                        revealBtn.style.display = 'inline-block';
                    }
                    if (mainTitleEl && (!cardEl || !cardEl.classList.contains('content-revealed'))) {
                       mainTitleEl.innerHTML = "✨ KEAJAIBAN SAMUDRA TELAH TERUNGKAP! ✨";
                    }
                    if (subtitleEl && (!cardEl || !cardEl.classList.contains('content-revealed'))) {
                       subtitleEl.innerHTML = `{{NAME}}, sebuah pesan dari jiwa samudra menantimu! 📜<br>Sentuh tombol di bawah untuk mengungkapnya!`;
                       subtitleEl.style.animation = 'none'; 
                       subtitleEl.style.opacity = '0.93';   
                    }
                } else { 
                    const distance = targetBirthdayTime - now;
                    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                    const daysEl = document.getElementById('days');
                    const hoursEl = document.getElementById('hours');
                    const minutesEl = document.getElementById('minutes');
                    const secondsEl = document.getElementById('seconds');
                    if(daysEl) daysEl.textContent = String(days).padStart(2, '0');
                    if(hoursEl) hoursEl.textContent = String(hours).padStart(2, '0');
                    if(minutesEl) minutesEl.textContent = String(minutes).padStart(2, '0');
                    if(secondsEl) secondsEl.textContent = String(seconds).padStart(2, '0');
                    
                    if (countdownEl) countdownEl.style.display = 'grid'; 
                    if (revealBtn) revealBtn.style.display = 'none'; 
                    if (birthdayContentEl) birthdayContentEl.style.display = 'none';
                    if (cardEl) cardEl.classList.remove('content-revealed');
                }
            }

            createBioluminescentPlankton();
            createWaterBubbles();
            
            const countdownInterval = setInterval(updateCountdown, 1000);
            updateCountdown();
        });
    </script>
</body>
</html>
